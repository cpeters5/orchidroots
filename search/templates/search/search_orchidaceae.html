{% load static %}
{% include "base.html" %}
{% block body %}
{% load testtags %}
<head>
    <title>Rearch resuolt for orchids</title>
    <meta name='description' content='Search result for orchids'>.

</head>
<style>
table {
      padding-top: 2px;
      padding-right: 10px;
      padding-bottom: 0;
      padding-left: 10px;
      margin-left: auto;
      margin-right: auto;
      width: 80%;
    font-size: 14px;
}
td {
    /*border: 1px solid lightgrey;*/
    padding: 10px;
}

.thumbnails {
   object-fit: cover;
   overflow: hidden;
   height: 70px;
   width : 70px;
   margin:5px auto;
}

@media only screen and (max-width: 600px) {
    table {
      padding-top: 2px;
      padding-right: 0;
      padding-bottom: 5px;
      padding-left: 0;
      margin-left: 0;
      margin-right: 0;
      font-size:12px;
    }
    .thumbnails {
       height: 50px;
       margin:5px auto;
    }
    td {
        min-width: 50px;
        min-height: 50px;
    }
}
.dataTables_wrapper .row {
    width: 90%;
    margin: 0 auto; /* Center the row if necessary */
}
.dataTables_wrapper .dataTables_info {
    padding-bottom: 5px;  /* Adds padding below the table info and above pagination controls */
    text-align: center;
    float: none;
    clear: both;
    margin: 10px auto; /* Add some margin for better spacing */
}
.dataTables_wrapper .dataTables_paginate .paginate_button {
    text-align: center;
    float: none;
    clear: both;
    padding: 2px 8px; /* Increase padding to make buttons larger */
    font-size: 14px; /* Adjust font size as needed */
    line-height: 1.5; /* Adjust line height for better vertical alignment */
}

/* You might also want to adjust the hover and active states */
.dataTables_wrapper .dataTables_paginate .paginate_button:hover {
    background-color: white; /* Example hover background color */
}

.dataTables_wrapper .dataTables_paginate .paginate_button:active {
    box-shadow: inset 0 0 3px #666; /* Example active state shadow */
    text-align: center;
    float: none; /* Override default floating */
}
.no-border-bg {
    background: none !important;
    border: none !important;
}

.dataTables_filter label {
    font-size: 14px; /* Adjust the size as needed */
}

    @keyframes flash {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }
    .flashing-button {
      animation: flash 1s linear infinite;
    }

</style>
<div style="min-height:200px;background-color:white;width: 100%;text-align: left;">
    <div style="text-align: center;width: 90%; margin: 0 auto;">
        <br>
        <h1 class="hidden-h1">Search_orchidaceae.html results for  "<i>{{search_string}}</i>"
            {% if matched_genus %}in {{app}}{% endif %}</h1>
        <h5 class="card-title" style="margin-bottom: 0">Search_orchidaceae.html results for  "<i>{{search_string}}</i>"
            {% if matched_genus %}in {{app}}{% endif %}</h5>
        <div id="accordion">
<!--            <div class="card mt-1 no-border-bg">-->
<!--&lt;!&ndash;                <div class="card-header no-border-bg">&ndash;&gt;-->
<!--&lt;!&ndash;                    <button class="btn btn-danger  flashing-button" type="button" data-toggle="collapse" data-target="#Help">&ndash;&gt;-->
<!--&lt;!&ndash;                        <h6 class="card-title" style="margin-bottom: 0; width: 120px;"><b>HELP</b></h6>&ndash;&gt;-->
<!--&lt;!&ndash;                    </button>&ndash;&gt;-->
<!--                </div>-->
                {% include "search/search_guide.html" %}

                <h6>Dont see what you are looking for?  Try searching for common name
                <a class="btn btn-primary" href="{% url 'search:search_name' %}?role={{role}}&commonname={{search_string}}">common name</a>
                </h6>

<!--                <form action="{% url 'search:search_name' %}" method="post">-->
<!--                   {% csrf_token %}-->
<!--                    <select class="btn btn-custom" name="selected_app" onchange="handleSelect(this)">-->
<!--                        <option value="">See other domain</option>-->
<!--                        {% for option in options %}-->
<!--                            <option value="{{ option.value }}" {% if selected_app  == option.value %}selected{% endif %}>-->
<!--                                {{ option.text }}-->
<!--                            </option>-->
<!--                        {% endfor %}-->
<!--                    </select>-->
<!--                    <input type="hidden" name="commonname" value="{{ commonname }}">-->
<!--                </form>-->


            </div>
        </div>
    {% if matched_genus %}
    <table class="table table-condensed  table-hover" style="padding-bottom: 0px; width: 85%;">
        <tr>
            {% for match in matched_genus %}
            <td>
                {% if not match.type == 'species' %}
                    <a href="{% url 'orchidaceae:species' %}?app={{match.family.application}}&role={{role}}&family=Orchidaceae&genus={{match}}"><i>{{match}}</i></a> {{matched_genus.author|default:''}} {{matched_genus.year|default:''}}
                    {% if matched_genus.status == 'synonym' %}<br>(syn.){% endif %}
                {% else %}
                     <a href="{% url 'orchidaceae:hybrid' %}?app={{match.family.application}}&role={{role}}&family=Orchidaceae&genus={{match}}"><i>{{match.genus}}</i></a>  {{matched_genus.author|default:''}} {% if matched_genus.status == 'synonym' %}(syn.){% endif %}
                {% endif %}
                {% if user.tier.tier > 3 %}
                {{match.pid|default:''}}
                {% endif %}
            </td>
            {% endfor %}
        </tr>
    </table>
    {% endif %}
    {% if match_spc_list %}
        <table id="sortTable" class="table-bordered table-condensed table-sm table-hover border" style="font-size: 14px; width: 100%" >
            <thead>
                <tr style="text-align: left; border-bottom:none">
                    <th class="spc_column">Species</th>
                    <th class="d-none d-lg-table-cell" style="text-align: center">Sample images</th>
                </tr>
            </thead>
        {% for species in match_spc_list %}
            <tr style="background-color: white;">
                <td style="text-align: left; border-bottom:none">
                    <a href="{% url 'display:summary' species.family.application species.pid %}?role={{role}}&related=ALL&syn=Y&searchdata={{searchdata}}">
                        <i>{{species.binomial|safe}}</i>
                    </a>
                    {{species.author|default:''}} {{species.year|default:''}}
                    {{species.accepted.common_name|default:''}}
                    {% if species.status == 'synonym' %}(syn. {{species.getAccepted.binomial_it|safe}}){% endif %}
                    {% if user.tier.tier > 3 %}
                        <br>{{species.pid}}-{{species.getAccepted.pid}} {{species.speciesstat.num_image|default:''}}
                    {% endif %}
                </td>
                <td style="text-align: center; border-bottom:0">
                    {% if species.get_best_img %}
                     <img class="thumbnails" alt="{{species.name|safe}}" src="{% static species.get_best_img.thumb_dir %}{{species.get_best_img.image_file}}">
                    {% endif %}
                </td>
            </tr>
        {% endfor %}

    {% else %}
        <tr><td></td><td></td></tr>
    {% endif %}
    {% if other_genus_spc %}
        {% for species in other_genus_spc %}
            <tr style="background-color: white;">
                <td style="min-width:100px; text-align: center">
                    {% if species.get_best_img %}
                     <img class="thumbnails" alt="{{species.name|safe}}" src="{% static species.get_best_img.thumb_dir %}{{species.get_best_img.image_file}}">
                    {% endif %}
                </td>
                <td>
                    <a href="{% url 'display:summary' species.family.application species.pid %}?role={{role}}&related=ALL&syn=Y&searchdata={{searchdata}}">
                        <i>{{species.binomial|safe}}</i>
                    </a>
                    {{species.author|default:''}} {{species.year|default:''}} {% if species.status == 'synonym' %}(syn. {{species.getAccepted.binomial_it|safe}}){% endif %}
                        (<i>{{species.family|default:''}}</i>
                        {% if species.family.application == 'other' or species.family.application == 'orchidaceae' %}Plantae{% else %}{{species.family.application}}{% endif %})
                </td>
                <td>{{species.accepted.common_name|default:''}}</td>
                <td>{{species.distribution|default:''}}</td>
                {% if user.tier.tier == 3 %}
                <td class="d-none d-lg-table-cell hidden-xs" style="text-align: center;">{{species.speciesstat.num_image|default:''}}</td>
                {% endif %}
            </tr>
        {% endfor %}

    {% endif %}
    </table>
</div>
</div>
</div>


{% include "base-datatable.html" %}

<script>

    (function($) {

  $('#search-button').on('click', function(e) {
    if($('#search-input-container').hasClass('hdn')) {
      e.preventDefault();
      $('#search-input-container').removeClass('hdn')
      return false;
    }
  });

  $('#hide-search-input-container').on('click', function(e) {
    e.preventDefault();
    $('#search-input-container').addClass('hdn')
    return false;
  });

})(jQuery);


document.getElementById('search').addEventListener('submit', function(event) {
    var input = document.getElementById('your-input-id').value;
    if (!/^[\u0000-\u007F]*$/.test(input)) {
        event.preventDefault();
        alert('Please use only supported characters.');
    }
});



$(document).ready(function(){
    $('[data-toggle="tooltip"]').tooltip();
    var initialFilterValue = "{{ spc | default:'' | escapejs }}";
    var table = $('#sortTable').DataTable({
        "info": true,
        "paging": true,  // Enable paging
        "lengthChange": false,
        "pageLength": 50,
        "lengthMenu": [[50,100,150,200,250,300,-1], [50,100,150,200,250,300,"All"]],
        "colReorder": true,
        "columnDefs": [
            { "type": "priority", "targets": 1 },
            // { targets: [5, 6, 7], className: 'none' }
        ],
        "order": [[0,'asc'],],
        responsive: true,
        "dom": "<'row'<'col-sm-6'f><'col-sm-6'p>>" +  // Top pagination
               "<'row'<'col-sm-12'tr>>" +
               "<'row'<'col-sm-5'i><'col-sm-7'p>>",  // Bottom pagination

        language: {
            search: "_INPUT_",
            "sProcessing": "Processing...",
            "sZeroRecords": "No match results",
        },
        "drawCallback": function(settings) {
            var api = this.api();
            var pageInfo = api.page.info();

            // Show/hide info and pagination
            $('.dataTables_info, .dataTables_paginate').toggle(pageInfo.pages > 1);

            // Adjust the filter and top pagination position
            if (pageInfo.pages <= 1) {
                $('.dataTables_filter').css({
                    'float': 'left',
                    'margin-bottom': '10px'
                });
                $('.dataTables_paginate:eq(0)').hide();  // Hide top pagination if only one page
            } else {
                $('.dataTables_filter').css({
                    'float': 'left',
                    'margin-bottom': '0'
                });
                $('.dataTables_paginate:eq(0)').show().css('float', 'right');  // Show top pagination
            }

            // Log info for debugging
            console.log("Total pages:", pageInfo.pages);
            console.log("Current page:", pageInfo.page);
            console.log("Total records:", pageInfo.recordsTotal);
        },

        "initComplete": function(settings, json) {
            $('.dataTables_filter input').attr('placeholder', 'Filter results');
        }
    });

    // Set initial filter value and draw table
    $('.dataTables_filter input').val(initialFilterValue);
    table.search(initialFilterValue).draw();
});

</script>


{% endblock %}
