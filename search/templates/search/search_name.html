{% load static %}
{% include "base.html" %}
{% block body %}
{% load testtags %}
<style>
table {
      padding-top: 2px;
      padding-right: 10px;
      padding-bottom: 10px;
      padding-left: 10px;
      margin-left: auto;
      margin-right: auto;
       width: 100%;
}
td {
    border: 0;
    padding: 10px;
}
.thumbnails {
   object-fit: cover;
   overflow: hidden;
   height: 70px;
   width : 70px;
   margin:5px auto;
}

@media only screen and (max-width: 600px) {
    table {
        width: 100%;
        font-size:12px;
    }
    .thumbnails {
       height: 80px;
       margin:5px auto;
    }
    td {
        border: 0;
        padding-left: 10px;
        min-height: 50px;
    }
.dataTables_wrapper .row {
    width: 90%;
    margin: 0 auto; /* Center the row if necessary */
}
.dataTables_wrapper .dataTables_info {
    padding-bottom: 5px;  /* Adds padding below the table info and above pagination controls */
    text-align: center;
    float: none;
    clear: both;
    margin: 10px auto; /* Add some margin for better spacing */
}
.dataTables_wrapper .dataTables_paginate .paginate_button {
    text-align: center;
    float: none;
    clear: both;
    padding: 2px 8px; /* Increase padding to make buttons larger */
    font-size: 14px; /* Adjust font size as needed */
    line-height: 1.5; /* Adjust line height for better vertical alignment */
}

/* You might also want to adjust the hover and active states */
.dataTables_wrapper .dataTables_paginate .paginate_button:hover {
    background-color: #f0f0f0; /* Example hover background color */
}

.dataTables_wrapper .dataTables_paginate .paginate_button:active {
    box-shadow: inset 0 0 3px #666; /* Example active state shadow */
    text-align: center;
    float: none; /* Override default floating */
}
.no-border-bg {
    background: none !important;
    border: none !important;
}

.dataTables_filter label {
    font-size: 14px; /* Adjust the size as needed */
}

}
</style>
<div style="min-height:200px;background-color:white;width: 100%;">
    <div style="clear:both"></div>
    <div class="row" style="margin:0 auto;">
        <div class="col" style="text-align:left;font-size:13px;margin-top:25px;">
            <div class="card-body"  style="width:100%; display:inline-block; padding-top:0;text-align: center;">
                <br>
                <form action="{% url 'search:search_name' %}" method="post">
                   {% csrf_token %}
                    <select class="btn btn-custom" name="selected_app" onchange="handleSelect(this)">
                        <option value="">Select domain</option>
                        {% for option in options %}
                            <option value="{{ option.value }}" {% if selected_app  == option.value %}selected{% endif %}>
                                {{ option.text }}
                            </option>
                        {% endfor %}
                    </select>
                    <input type="hidden" name="commonname" value="{{ commonname }}">
                </form>
                <br><br>
                {% if not family_list and not genus_list and not species_list %}
                <div style="text-align: center;font-size: 16px;">
                   {% if selected_app %}
                       <h6>
                        No record found in our system matching commonname "{{commonname}}"
                            in domain {{selected_app|default:'all'|title }}
                        </h6>
                    {% else %}
                        <h6>No record found in our system matching commonname "{{commonname}}"</h6>
                   {% endif %}
                    Ensure that the "Select Domain" button is set to "All Domains" or to a specific domain relevant to your search, if known.
                    <br>
                    You may also try the "Scientific/registered name search in case "{{commonname}}" is a taxon or a registered hybrid.
                </div>
                {% else %}

                {% if species_list %}
                <div style="text-align: center;">
                    <h5>
                        <b>{{selected_app|default:'all'|title }}</b> Species with common name contains "{{commonname}}"
                    </h5>
                </div>
                <table id="sortTable" class="table table-condensed table-sm table-hover" style="font-size: 13px;" >
                    <thead style="text-align: center;"><th>Sample image</th><th>Species</th><th>common name</th><th>distribution</th></thead>
                    {% for species in species_list %}
                        <tr >
                            <td style="width:20%;">{{species.img.image_file}}
                                {% if species.img_pid %}
                                <a href="{% url 'display:photos' species.pid %}?family={{species.family}}&role={{role}}">
                                 <img class="thumbnails" alt="{{species.img}}" src="{% static species.image_dir %}{{species.image_file}}">
                                </a>
                                {% endif %}
                            </td>
                            <td style="width:10%;text-align: left;">
                                {% if role == 'cur' %}
                                    <a href="{% url 'display:photos' species.pid %}?family={{species.gen.family}}&role={{role}}">{{species.binomial|safe}}</a>
                                {% else %}
                                    <a href="{% url 'display:information' species.pid %}?family={{species.gen.family}}">{{species.binomial|safe}}</a>
                                {% endif %}
                                ({{species.family.family}})
                                {% if species.status == 'synonym' %}<br> (syn. {{species.acc.binomial}}){% endif %}
                            </td>
                            <td style="text-align: left;">{{species.name|default:''}}</td>
                            <td style="text-align: left;">{{species.accepted.distribution|default:''}}</td>
                        </tr>

                    {% endfor %}
                </table>
                {% endif %}
            {% endif %}


            </div>
        </div>
    </div>
</div>

<script>

$(document).ready(function(){
    $('a[data-toggle="tab"]').on('show.bs.tab', function(e) {
        localStorage.setItem('activeTab', $(e.target).attr('href'));
    });
    var activeTab = localStorage.getItem('activeTab');
    if(activeTab){
        $('#myTab a[href="' + activeTab + '"]').tab('show');
    }
});

    $(document).ready(function() {
        var dataTable = $('#sortTable').dataTable({
        "pageLength": 20,
        "drawCallback": function(settings) {
            var api = this.api();
            var rows = api.rows({page: 'current'}).nodes();
            var lastRow = api.row(rows.length - 1, {page: 'current'}).index();
            var totalRecords = api.page.info().recordsDisplay;

            // Check if the total records are less than the page length
            if (totalRecords <= api.page.len()) {
                $('.dataTables_paginate').hide(); // Hide pagination
                $('.dataTables_filter').hide();   // Hide search box
            } else {
                $('.dataTables_paginate').show(); // Show pagination
                $('.dataTables_filter').show();   // Show search box
            }
        },
        "info": false,
        "pagingType": "full",
        "order": [],
        "aLengthMenu": [[50,100,150,200,250,300,-1], [50,100,150,200,250,300,"All"]],
        "lengthChange": false,
        "bPaginate": true,
        "pagingType": "numbers",
        "fnPreDrawCallback": function( oSettings ) {
        $('.dataTables_filter input').attr({'name':'','placeholder': 'search'});//tips
    },
        // "dom": '<"top"i>rt<"bottom"flp><"clear">',
        // "dom": '<"top"flp>rt<"bottom"i><"clear">',
        // "dom": '<"wrapper"flipt>',
        // "dom": "<'row'<'col-md-6'l><'col-md-6'Bf>>" + "<'row'<'col-md-6'><'col-md-6'>>" + "<'row'<'col-md-12't>><'row'<'col-md-12'ip>>",
        // "dom": "<'row'<'col-sm-12'tr>>" + "<'row'<'col-sm-4'f><'col-sm-8'p>>",
        // "dom": "<'row'<'col-sm-4'f><'col-sm-8'p>>" + "<'row'<'col-sm-12'tr>>",
        "dom": "<'row'<'col-sm-4'f><'col-sm-4'i><'col-sm-4'p>>" + "<'row'<'col-sm-12'tr>>",
        // "sDom": '<"top"flp>rt<"bottom"ip><"clear">',
        language: {
        search: "_INPUT_",
        "sProcessing": "Processing...",
        "sZeroRecords": "No match results",
        // "sSearch": "Searching:",
        // searchPlaceholder: "Search this page"
    }
    });
    });


    function handleSelect(select) {
      var selectedOption = select.value;
      console.log("Selected option:", selectedOption);
      // Perform further actions based on the selected option
      // e.g., submit the form programmatically, redirect, etc.
      select.form.submit();
    }


</script>



{% endblock %}
